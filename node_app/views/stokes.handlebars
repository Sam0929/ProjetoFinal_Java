<!DOCTYPE html>
<html lang="pt_BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Ações</title>
    <link rel="stylesheet" href="../public/css/stokes.css">
</head>
<body>
<main>
    <div class="box">
      <div class="inner-box">
        <div class="forms-wrap">
            <form class="form-stokes" action="/user/stokes/add" method="POST">
                <div class="heading">
                    <h1>Adicionar Ações</h1>
                    <small>Encontre as ações pelos símbolos</small>
                </div>
                
                <div class="form-labels">
                    <div class="input-wrap">
                        <input type="text" name="stoke"  id="input-box" class="input-field" />
                        <label class="form-label" for="input-box">Símbolo da Ação Buscada</label>
                    </div>
                    <div class="result-box"></div>
                    <input type="submit" class="sign-btn" value="Adicionar">
                </div>
            </form>
            <div class="form-stokes">
                <div class="heading">
                    <h1>Remover Ações</h1>
                    <small>Remova as ações que não te interessam mais</small>
                </div>
                {{#if stokes}}
                    <ul class="deleteStokes">
                    {{#each stokes}}
                        <li>
                        <h4>{{this}}</h4>
                        <form action="/user/stokes/delete/" method="POST">
                            <input hidden name="stoke" value="{{this}}">
                        <button class="sign-btn">Deletar</button>
                        </form>
                        </li>
                    {{/each}}
                    </ul>
                {{/if}}
            </div>          
        </div>

        <div class="image">
          <img src="../public/img/stokes_img.webp" alt="">
        </div>
      </div>
    </div>

</main>
<script>
    const inputs = document.querySelectorAll(".input-field");
    const resultsBox = document.querySelector(".result-box");
    const inputBox = document.getElementById("input-box");

    var list = {{{json stokesSymbols}}};
    const availableKeywords = list.map(function(item) {
        return item.symbol;
    });

    inputBox.onkeyup = function() {
        let result = [];
        let input = inputBox.value;
        if(input.length){
            result = availableKeywords.filter((keyword)=>{
                return keyword.toUpperCase().includes(input.toUpperCase());
            });
        }
        display(result);
    }

    function display(result){
        const content = result.map((list)=>{
            return "<li onclick=selectInput(this)>" + list + "</li>";
        });

        resultsBox.innerHTML = "<ul>" + content.join('') + "</ul>";
    }

    function selectInput(list){
        inputBox.value = list.innerHTML;
        resultsBox.innerHTML = '';
    }

    inputs.forEach((inp) => {
      inp.addEventListener("focus", () =>{
        inp.classList.add("active");
      });
      inp.addEventListener("blur", () => {
        if(inp.value != "") return;
        inp.classList.remove("active")
      });
    })
</script>
</body>
</html>